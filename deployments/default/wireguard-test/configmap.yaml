---
apiVersion: v1
kind: ConfigMap
metadata:
  labels:
    app: wireguard-test
  name: wireguard-test
data:
  wireguard.conf: |-
    [Interface]
    PrivateKey = BdOIAufvwvpRFHjXYFSMvRc4NYSweQVUm002+BKYENc=
    Address = 10.70.6.214/32
    DNS = 193.138.218.74
    PostUp = DROUTE=$(ip route | grep default | awk '{print $3}'); HOMENET1=172.17.0.0/16; HOMENET2=10.43.0.0/16; ip route add $HOMENET2 via $DROUTE;ip route add $HOMENET1 via $DROUTE; iptables -I OUTPUT -d $HOMENET1 -j ACCEPT;iptables -A OUTPUT -d $HOMENET2 -j ACCEPT; iptables -A OUTPUT ! -o %i -m mark ! --mark $(wg show %i fwmark) -m addrtype ! --dst-type LOCAL -j REJECT
    PreDown = HOMENET1=172.17.0.0/16; HOMENET2=10.43.0.0/16; ip route del $HOMENET2 via $DROUTE;ip route del $HOMENET1 via $DROUTE; iptables -D OUTPUT -d $HOMENET1 -j ACCEPT;iptables -A OUTPUT -d $HOMENET2 -j ACCEPT; iptables -D OUTPUT ! -o %i -m mark ! --mark $(wg show %i fwmark) -m addrtype ! --dst-type LOCAL -j REJECT

    [Peer]
    PublicKey = vyiKBvye/1shpkYc0nuSt5GuwkgWb6g3Ft98suUbhnc=
    AllowedIPs = 0.0.0.0/0,::0/0
    Endpoint = 31.7.59.250:51820
