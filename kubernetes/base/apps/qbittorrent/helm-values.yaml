---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: common
spec:
  values:
    global:
      nameOverride: qbittorrent

    image:
      repository: ghcr.io/k8s-at-home/qbittorrent
      tag: v4.4.2
      pullPolicy: Always

    env:
      UMASK: "022"
      USE_PROFILE: "true"

    persistence:
      cache:
        enabled: true
        type: emptyDir
        mountPath: /config/qBittorrent/cache

      config:
        enabled: true
        type: emptyDir
        mountPath: /config/qBittorrent/config

      data:
        enabled: true
        existingClaim: qbittorrent-config
        mountPath: /config/qBittorrent/data

    service:
      main:
        ports:
          http:
            port: 8080

    resources:
      requests:
        cpu: 35m
        memory: 765M
      limits:
        memory: 1426M
